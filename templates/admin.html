
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Admin ‚Ä¢ ENERGY LIFE</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}"/>
</head>
<body class="bg">
<div class="shell">
  <header class="top bar">
    <div class="row gap">
      <a class="btn" href="{{ url_for('home') }}">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏ö‡πâ‡∏≤‡∏ô</a>
      <div>
        <div class="title">üõ† Admin Dashboard</div>
        <div class="subtitle">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏Ñ‡∏ô‡πÄ‡∏•‡πà‡∏ô + ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (MVP)</div>
      </div>
    </div>
    <div class="row gap">
      <a class="btn ghost" href="{{ url_for('logout') }}">‡∏≠‡∏≠‡∏Å</a>
    </div>
  </header>

  <main class="grid2">
    <section class="card">
      <h2>‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h2>
      <div class="grid3 mt">
        <div class="mini"><div class="mini-title">‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div><div class="big">{{ total_users }}</div></div>
        <div class="mini"><div class="mini-title">Active ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div><div class="big">{{ todays }}</div></div>
        <div class="mini"><div class="mini-title">Active 7 ‡∏ß‡∏±‡∏ô</div><div class="big">{{ active_7d }}</div></div>
      </div>
      <div class="grid3 mt2">
        <div class="mini"><div class="mini-title">Active 30 ‡∏ß‡∏±‡∏ô</div><div class="big">{{ active_30d }}</div></div>
        <div class="mini"><div class="mini-title">kWh ‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢/‡∏ß‡∏±‡∏ô (‡∏£‡∏∞‡∏ö‡∏ö)</div><div class="big">{{ "%.2f"|format(avg_kwh) }}</div></div>
        <div class="mini"><div class="mini-title">‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢/‡∏ß‡∏±‡∏ô (‡∏£‡∏∞‡∏ö‡∏ö)</div><div class="big">{{ "%.2f"|format(avg_cost) }}</div></div>
      </div>

      <div class="divider"></div>

      <h2>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (MVP)</h2>
      <form method="post" action="{{ url_for('admin_settings') }}" class="form">
        <div class="grid3">
          <div>
            <label>Non‚ÄëTOU (‡∏ø/kWh)</label>
            <input name="non_tou_rate" value="{{ settings.non_tou_rate }}"/>
          </div>
          <div>
            <label>TOU On‚ÄëPeak (‡∏ø/kWh)</label>
            <input name="tou_on_rate" value="{{ settings.tou_on_rate }}"/>
          </div>
          <div>
            <label>TOU Off‚ÄëPeak (‡∏ø/kWh)</label>
            <input name="tou_off_rate" value="{{ settings.tou_off_rate }}"/>
          </div>
        </div>
        <div class="grid3 mt2">
          <div>
            <label>On‚ÄëPeak Start (‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)</label>
            <input name="on_peak_start" value="{{ settings.on_peak_start }}"/>
          </div>
          <div>
            <label>On‚ÄëPeak End (‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)</label>
            <input name="on_peak_end" value="{{ settings.on_peak_end }}"/>
          </div>
          <div class="row end">
            <button class="btn primary" type="submit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
          </div>
        </div>
      </form>
    </section>

    <aside class="card">
      <h2>‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h2>
      <div class="tablewrap">
        <table>
          <thead><tr><th>ID</th><th>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</th><th>Role</th><th>Points</th><th>Lv</th><th></th></tr></thead>
          <tbody>
            {% for u in users %}
              <tr>
                <td>{{ u.id }}</td>
                <td>{{ u.username }}</td>
                <td>{{ u.role }}</td>
                <td>{{ u.points if u.points is not none else 0 }}</td>
                <td>{{ u.house_level if u.house_level is not none else 1 }}</td>
                <td><a class="btn" href="{{ url_for('admin_user', user_id=u.id) }}">‡∏î‡∏π‡∏ö‡πâ‡∏≤‡∏ô</a></td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>

      <div class="divider"></div>
      <div class="muted small">
        *‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Admin: <b>admin</b>/<b>admin1234</b> (‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ENV: ENERGY_LIFE_ADMIN_PASS)
      </div>
    </aside>
  </main>
</div>
</body>
</html>
