<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô ‚Ä¢ ENERGY LIFE</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}"/>
</head>
<body class="bg">
<div class="shell">
  <header class="top bar">
    <div class="row gap">
      <div class="badge">{{ levels[house_level-1].badge }}</div>
      <div>
        <div class="title">‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á {{ profile.display_name if profile.display_name else user.username }}</div>
        <div class="subtitle">
          <span class="muted">‡πÇ‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á</span>
          ‚Ä¢ TOU: <b id="statTariff">{{ state.tariff_mode }}</b>
          ‚Ä¢ Solar: <b id="statSolar">{{ state.solar_kw }}</b> kW
          ‚Ä¢ EV: <b id="statEv">{{ "ON" if state.ev_enabled else "OFF" }}</b>
        </div>
      </div>
    </div>

    <!-- ‡πÄ‡∏°‡∏ô‡∏π: ‡πÇ‡∏´‡∏°‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á (‡∏ã‡πà‡∏≠‡∏ô‡πÄ‡∏Å‡∏°) -->
    <div class="row gap">
      <a class="btn" href="{{ url_for('home') }}">üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
      <a class="btn" href="{{ url_for('dashboard') }}">üìä Dashboard</a>
      <a class="btn" href="{{ url_for('user_settings') }}">‚öôÔ∏è ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</a>
      {% if user.role in ['admin','officer'] %}
        <a class="btn" href="{{ url_for('admin') }}">üõ† Admin</a>
      {% endif %}
      <a class="btn ghost" href="{{ url_for('logout') }}">‡∏≠‡∏≠‡∏Å</a>
    </div>
  </header>

  <main class="grid2">
    <!-- LEFT: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ -->
    <section class="card">
      <h2>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ ‚Äú‡∏ö‡πâ‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‚Äù</h2>

      <div class="grid3 mt">
        <div class="mini">
          <div class="mini-title">üë§ ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</div>
          <select id="player_type">
            <option value="kid" {{ 'selected' if profile.player_type=='kid' else '' }}>‡πÄ‡∏î‡πá‡∏Å</option>
            <option value="adult" {{ 'selected' if profile.player_type=='adult' else '' }}>‡∏ú‡∏π‡πâ‡πÉ‡∏´‡∏ç‡πà</option>
            <option value="family" {{ 'selected' if profile.player_type=='family' else '' }}>‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡∏ß</option>
          </select>
        </div>
        <div class="mini">
          <div class="mini-title">üè† ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ö‡πâ‡∏≤‡∏ô</div>
          <select id="house_type">
            <option value="condo" {{ 'selected' if profile.house_type=='condo' else '' }}>‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î</option>
            <option value="single_1" {{ 'selected' if profile.house_type=='single_1' else '' }}>‡∏ö‡πâ‡∏≤‡∏ô 1 ‡∏ä‡∏±‡πâ‡∏ô</option>
            <option value="single_2" {{ 'selected' if profile.house_type=='single_2' else '' }}>‡∏ö‡πâ‡∏≤‡∏ô 2 ‡∏ä‡∏±‡πâ‡∏ô</option>
          </select>
        </div>
        <div class="mini">
          <div class="mini-title">üìè ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ö‡πâ‡∏≤‡∏ô</div>
          <select id="house_size">
            <option value="small" {{ 'selected' if profile.house_size=='small' else '' }}>‡πÄ‡∏•‡πá‡∏Å</option>
            <option value="medium" {{ 'selected' if profile.house_size=='medium' else '' }}>‡∏Å‡∏•‡∏≤‡∏á</option>
            <option value="large" {{ 'selected' if profile.house_size=='large' else '' }}>‡πÉ‡∏´‡∏ç‡πà</option>
          </select>
        </div>
      </div>

      <div class="row gap mt">
        <div class="mini grow">
          <div class="mini-title">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡πÉ‡∏ô‡∏ö‡πâ‡∏≤‡∏ô</div>
          <input id="residents" type="number" min="1" max="12" value="{{ profile.residents }}"/>
        </div>
        <div class="mini grow">
          <div class="mini-title">üßæ ‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå</div>
          <select id="tariff_mode">
            <option value="non_tou" {{ 'selected' if state.tariff_mode=='non_tou' else '' }}>‡∏õ‡∏Å‡∏ï‡∏¥ (Non-TOU)</option>
            <option value="tou" {{ 'selected' if state.tariff_mode=='tou' else '' }}>TOU</option>
          </select>
        </div>
        <div class="mini grow">
          <div class="mini-title">‚òÄÔ∏è Solar Mode</div>
          <select id="solar_mode">
            <option value="manual" {{ 'selected' if state.solar_mode=='manual' else '' }}>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏≠‡∏á</option>
            <option value="advisor" {{ 'selected' if state.solar_mode=='advisor' else '' }}>‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</option>
          </select>
        </div>
        <div class="mini grow">
          <div class="mini-title">‚òÄÔ∏è Solar (kW)</div>
          <select id="solar_kw">
            {% for kw in [0,3,5,10] %}
              <option value="{{kw}}" {{ 'selected' if state.solar_kw==kw else '' }}>{{kw}} kW</option>
            {% endfor %}
          </select>
        </div>
      </div>

      <div class="divider"></div>

      <h3>‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (‡∏Ñ‡∏£‡∏ö‡∏ö‡πâ‡∏≤‡∏ô) üîå</h3>

      <div class="appliances">
        {% for a in appliances_catalog %}
          <div class="appliance card2" data-key="{{a.key}}">
            <div class="row between">
              <div class="row gap">
                <div class="ap-ico">{{ a.icon }}</div>
                <div>
                  <div class="ap-name">{{ a.name }}</div>
                  <div class="muted small">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏ö‡πâ‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á</div>
                </div>
              </div>
              <label class="switch">
                <input type="checkbox" class="ap-enabled" {{ 'checked' if state.appliances[a.key].enabled else '' }}>
                <span class="slider"></span>
              </label>
            </div>

            {% if a.key == 'ac' %}
              <div class="grid3 mt2">
                <div class="mini">
                  <div class="mini-title">BTU</div>
                  <select class="ac-btu">
                    {% for b in [9000,12000,18000,24000] %}
                      <option value="{{b}}" {{ 'selected' if state.appliances.ac.btu==b else '' }}>{{b}}</option>
                    {% endfor %}
                  </select>
                </div>
                <div class="mini">
                  <div class="mini-title">‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (¬∞C)</div>
                  <input type="number" min="16" max="30" class="ac-temp" value="{{ state.appliances.ac.set_temp }}"/>
                </div>
                <div class="mini">
                  <div class="mini-title">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á/‡∏ß‡∏±‡∏ô</div>
                  <input type="number" step="0.5" min="0" max="24" class="ac-hours" value="{{ state.appliances.ac.hours }}"/>
                </div>
              </div>
              <div class="grid3 mt2">
                <div class="mini">
                  <div class="mini-title">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î (‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)</div>
                  <input type="number" min="0" max="23" class="ac-start" value="{{ state.appliances.ac.start_hour }}"/>
                </div>
                <div class="mini">
                  <div class="mini-title">‡∏õ‡∏¥‡∏î (‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)</div>
                  <input type="number" min="0" max="23" class="ac-end" value="{{ state.appliances.ac.end_hour }}"/>
                </div>
                <div class="mini">
                  <div class="mini-title">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</div>
                  <div class="muted small">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≤‡∏°‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á‡∏Ñ‡∏∑‡∏ô (‡πÄ‡∏ä‡πà‡∏ô 20‚Üí2)</div>
                </div>
              </div>
              <div class="row gap mt2">
                <label class="pill">
                  <input type="checkbox" class="ac-inverter" {{ 'checked' if state.appliances.ac.inverter else '' }}>
                  Inverter
                </label>
                <div class="muted small">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ï‡∏±‡πâ‡∏á 26¬∞C ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î</div>
              </div>
            {% elif a.key == 'lights' %}
              <div class="grid3 mt2">
                <div class="mini">
                  <div class="mini-title">‡∏ä‡∏ô‡∏¥‡∏î‡∏´‡∏•‡∏≠‡∏î</div>
                  <select class="li-mode">
                    <option value="LED" {{ 'selected' if state.appliances.lights.mode=='LED' else '' }}>LED</option>
                    <option value="NORMAL" {{ 'selected' if state.appliances.lights.mode!='LED' else '' }}>‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤</option>
                  </select>
                </div>
                <div class="mini">
                  <div class="mini-title">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏ü‡∏£‡∏ß‡∏° (W)</div>
                  <input type="number" min="1" max="2000" class="li-watts" value="{{ state.appliances.lights.watts }}"/>
                </div>
                <div class="mini">
                  <div class="mini-title">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á/‡∏ß‡∏±‡∏ô</div>
                  <input type="number" step="0.5" min="0" max="24" class="li-hours" value="{{ state.appliances.lights.hours }}"/>
                </div>
              </div>
            {% elif a.key == 'fridge' %}
              <div class="row gap mt2">
                <div class="mini grow">
                  <div class="mini-title">‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô (kWh)</div>
                  <input type="number" step="0.1" min="0" max="10" class="fr-kwh" value="{{ state.appliances.fridge.kwh_per_day }}"/>
                </div>
                <div class="muted small">‡πÇ‡∏î‡∏¢‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ 0.8‚Äì1.8 kWh/‡∏ß‡∏±‡∏ô</div>
              </div>
            {% else %}
              <div class="grid3 mt2">
                <div class="mini">
                  <div class="mini-title">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏ü (W)</div>
                  <input type="number" min="0" max="10000" class="ge-watts" value="{{ state.appliances[a.key].watts if 'watts' in state.appliances[a.key] else 0 }}"/>
                </div>
                <div class="mini">
                  <div class="mini-title">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á/‡∏ß‡∏±‡∏ô</div>
                  <input type="number" step="0.1" min="0" max="24" class="ge-hours" value="{{ state.appliances[a.key].hours if 'hours' in state.appliances[a.key] else 0 }}"/>
                </div>
                <div class="mini">
                  <div class="mini-title">‡∏ó‡∏¥‡∏õ</div>
                  <div class="muted small">‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ó‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô</div>
                </div>
              </div>
            {% endif %}
          </div>
        {% endfor %}
      </div>

      <div class="divider"></div>

      <h3>üöó ‡∏£‡∏ñ‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ (EV)</h3>
      <div class="row between">
        <div class="muted">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏ä‡∏≤‡∏£‡πå‡∏à EV ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏π‡πâ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ï‡πà‡∏≠ 1 ‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
        <label class="pill">
          <input id="ev_enabled" type="checkbox" {{ 'checked' if state.ev_enabled else '' }}>
          ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ EV
        </label>
      </div>

      <div id="ev_panel" class="grid3 mt2">
        <div class="mini">
          <div class="mini-title">‡πÅ‡∏ö‡∏ï (kWh)</div>
          <input id="ev_batt" type="number" step="1" min="20" max="120" value="{{ state.ev.battery_kwh }}"/>
        </div>
        <div class="mini">
          <div class="mini-title">Charger (kW)</div>
          <select id="ev_charger">
            {% for kw in [3.5,7.4,11,22] %}
              <option value="{{kw}}" {{ 'selected' if state.ev.charger_kw==kw else '' }}>{{kw}}</option>
            {% endfor %}
          </select>
        </div>
        <div class="mini">
          <div class="mini-title">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ä‡∏≤‡∏£‡πå‡∏à (‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)</div>
          <input id="ev_start" type="number" min="0" max="23" value="{{ state.ev.charge_start_hour }}"/>
        </div>
        <div class="mini">
          <div class="mini-title">‡∏ä‡∏≤‡∏£‡πå‡∏à‡∏à‡∏≤‡∏Å % ‚Üí %</div>
          <div class="row gap">
            <input id="ev_from" type="number" min="0" max="100" value="{{ state.ev.soc_from }}"/>
            <span class="muted">‚Üí</span>
            <input id="ev_to" type="number" min="0" max="100" value="{{ state.ev.soc_to }}"/>
          </div>
        </div>
      </div>

      <div class="row gap mt2">
        <button class="btn" id="saveBtn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
        <button class="btn primary" id="simBtn">‚ñ∂ ‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÑ‡∏õ‡∏≠‡∏µ‡∏Å 1 ‡∏ß‡∏±‡∏ô</button>
        <div class="muted small">Day: <b id="dayCounter">{{ state.day_counter }}</b></div>
      </div>
    </section>

    <!-- RIGHT: ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á -->
    <aside class="card">
      <h2>‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡πà‡∏≠ (‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á)</h2>
      <div class="grid3 mt2">
        <div class="mini">
          <div class="mini-title">‚ö° kWh ‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
          <div class="big" id="statKwhDay">‚Äî</div>
          <div class="muted small">‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
        </div>
        <div class="mini">
          <div class="mini-title">üí∞ ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>
          <div class="big" id="statCostDay">‚Äî</div>
          <div class="muted small">‡∏ö‡∏≤‡∏ó/‡∏ß‡∏±‡∏ô</div>
        </div>
        <div class="mini">
          <div class="mini-title">üìÖ ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì/‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</div>
          <div class="big" id="statCostMonth">‚Äî</div>
          <div class="muted small">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏à‡∏≤‡∏Å ‚Äú‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ √ó 30‚Äù</div>
        </div>
      </div>

      <div class="divider"></div>

      <h2>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</h2>
      <div class="panel" id="resultBox">
        <div class="muted">‡∏Å‡∏î ‚Äú‡∏à‡∏≥‡∏•‡∏≠‡∏á‡πÑ‡∏õ‡∏≠‡∏µ‡∏Å 1 ‡∏ß‡∏±‡∏ô‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏´‡∏ô‡πà‡∏ß‡∏¢‡πÑ‡∏ü‡πÅ‡∏•‡∏∞‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü</div>
      </div>

      <div class="divider"></div>

      <h3>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏£‡πá‡∏ß‡πÜ</h3>
      <ul class="tips">
        <li>‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏≠‡∏£‡πå <b>26¬∞C</b> ‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î</li>
        <li>‡πÄ‡∏õ‡∏¥‡∏î TOU ‡πÅ‡∏•‡πâ‡∏ß‡∏•‡∏≠‡∏á‡∏¢‡πâ‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡πÑ‡∏õ‡∏ä‡πà‡∏ß‡∏á <b>Off-Peak</b></li>
        <li>Solar ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏±‡∏ö‡∏ö‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡πÄ‡∏¢‡∏≠‡∏∞</li>
        <li>‡∏ä‡∏≤‡∏£‡πå‡∏à EV ‡∏ä‡πà‡∏ß‡∏á‡∏î‡∏∂‡∏Å‡∏à‡∏∞‡∏Ñ‡∏∏‡πâ‡∏°‡∏Å‡∏ß‡πà‡∏≤ (‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô TOU)</li>
      </ul>
    </aside>
  </main>
</div>

<script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
