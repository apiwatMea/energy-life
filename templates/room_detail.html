<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå ‚Ä¢ {{ room_id }} ‚Ä¢ ENERGY LIFE</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}"/>
</head>
<body class="bg">
<div class="shell">

  <header class="top bar">
    <div class="row gap">
      <a class="btn" href="{{ url_for('rooms_setup') }}">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡πâ‡∏≠‡∏á</a>
      <div>
        <div class="title">üß© ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå: {{ room_id }}</div>
        <div class="subtitle">‡∏õ‡∏£‡∏±‡∏ö‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏¢‡∏´‡πâ‡∏≠‡∏á (‡∏Ç‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà)</div>
      </div>
    </div>
  </header>

  <main class="card">

    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        <div class="mt">
        {% for cat,msg in messages %}
          <div class="toast {{cat}}">{{ msg }}</div>
        {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <div class="mini">
      <div class="mini-title">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡πâ‡∏≠‡∏á</div>
      <div class="muted">{{ room.type }}</div>
    </div>

    <form method="post" class="form mt">

      {% for key, cfg in room.appliances.items() %}
        {% set c = catalog.get(key) %}
        <div class="mini mt">
          <div class="row gap" style="justify-content:space-between;align-items:center;">
            <div>
              <div class="mini-title">{{ c.icon if c else "" }} {{ c.name if c else key }}</div>
              <div class="muted">key: {{ key }} | type: {{ c.type if c else "-" }}</div>
            </div>

            <label class="row gap" style="align-items:center;">
              <input type="checkbox" name="{{ key }}__enabled" {% if cfg.enabled %}checked{% endif %}>
              <span class="muted">‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
            </label>
          </div>

          {% if c and c.type == "ac" %}
            <div class="grid3 mt2">
              <div>
                <div class="muted small">BTU</div>
                <input type="number" name="{{ key }}__btu" value="{{ cfg.btu or 12000 }}" min="6000" max="60000">
              </div>
              <div>
                <div class="muted small">‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥ (¬∞C)</div>
                <input type="number" name="{{ key }}__set_temp" value="{{ cfg.set_temp or 26 }}" min="16" max="30">
              </div>
              <div>
                <div class="muted small">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á/‡∏ß‡∏±‡∏ô</div>
                <input type="number" step="0.1" name="{{ key }}__hours" value="{{ cfg.hours or 6 }}" min="0" max="24">
              </div>
            </div>

            <div class="grid3 mt2">
              <div>
                <div class="muted small">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î (‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)</div>
                <input type="number" name="{{ key }}__start_hour" value="{{ cfg.start_hour or 20 }}" min="0" max="23">
              </div>
              <div>
                <div class="muted small">‡∏õ‡∏¥‡∏î (‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á)</div>
                <input type="number" name="{{ key }}__end_hour" value="{{ cfg.end_hour or 2 }}" min="0" max="23">
              </div>
              <div class="row gap" style="align-items:center;margin-top:22px;">
                <input type="checkbox" name="{{ key }}__inverter" {% if cfg.inverter %}checked{% endif %}>
                <span class="muted">Inverter</span>
              </div>
            </div>

          {% elif c and c.type == "lights" %}
            <div class="grid3 mt2">
              <div>
                <div class="muted small">‡∏ä‡∏ô‡∏¥‡∏î‡∏´‡∏•‡∏≠‡∏î</div>
                <select name="{{ key }}__mode">
                  <option value="LED" {% if (cfg.mode or "LED") == "LED" %}selected{% endif %}>LED</option>
                  <option value="Normal" {% if (cfg.mode or "") == "Normal" %}selected{% endif %}>Normal</option>
                </select>
              </div>
              <div>
                <div class="muted small">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏ü‡∏£‡∏ß‡∏° (W)</div>
                <input type="number" step="1" name="{{ key }}__watts" value="{{ cfg.watts or 30 }}" min="0" max="5000">
              </div>
              <div>
                <div class="muted small">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á/‡∏ß‡∏±‡∏ô</div>
                <input type="number" step="0.1" name="{{ key }}__hours" value="{{ cfg.hours or 5 }}" min="0" max="24">
              </div>
            </div>

          {% elif c and c.type == "fridge" %}
            <div class="grid3 mt2">
              <div>
                <div class="muted small">kWh ‡∏ï‡πà‡∏≠‡∏ß‡∏±‡∏ô</div>
                <input type="number" step="0.1" name="{{ key }}__kwh_per_day" value="{{ cfg.kwh_per_day or 1.2 }}" min="0" max="30">
              </div>
            </div>

          {% else %}
            <div class="grid3 mt2">
              <div>
                <div class="muted small">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÑ‡∏ü (W)</div>
                <input type="number" step="1" name="{{ key }}__watts" value="{{ cfg.watts or 100 }}" min="0" max="100000">
              </div>
              <div>
                <div class="muted small">‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á/‡∏ß‡∏±‡∏ô</div>
                <input type="number" step="0.1" name="{{ key }}__hours" value="{{ cfg.hours or 1 }}" min="0" max="24">
              </div>
            </div>
          {% endif %}
        </div>
      {% endfor %}

      <div class="row gap mt">
        <button class="btn primary" type="submit">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        <a class="btn" href="{{ url_for('rooms_setup') }}">‡∏Å‡∏•‡∏±‡∏ö</a>
      </div>

    </form>
  </main>
</div>
</body>
</html>
