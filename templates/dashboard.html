
<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Dashboard ‚Ä¢ ENERGY LIFE</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}"/>
</head>
<body class="bg">
<div class="shell">
  <header class="top bar">
    <div class="row gap">
      <a class="btn" href="{{ url_for('home') }}">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏ö‡πâ‡∏≤‡∏ô</a>
      <div>
        <div class="title">üìä Dashboard (‡∏ö‡πâ‡∏≤‡∏ô‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏µ‡∏¢‡∏ß)</div>
        <div class="subtitle">‡∏™‡∏£‡∏∏‡∏õ kWh / ‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü / TOU / Solar / EV</div>
      </div>
    </div>
    <div class="row gap">
      <a class="btn ghost" href="{{ url_for('logout') }}">‡∏≠‡∏≠‡∏Å</a>
    </div>
  </header>

  <main class="card">
    <div class="row between">
      <div>
        <div class="title">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div>
        <div class="muted">Lv.{{ st.house_level }} ‚Ä¢ ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô {{ st.points }} ‚≠ê</div>
      </div>
      <div class="badge">{{ levels[st.house_level-1].badge }}</div>
    </div>

    <div class="grid3 mt">
      <div class="mini">
        <div class="mini-title">‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå</div>
        <div class="big">{{ st.state.tariff_mode }}</div>
      </div>
      <div class="mini">
        <div class="mini-title">Solar</div>
        <div class="big">{{ st.state.solar_kw }} kW</div>
        <div class="muted small">mode: {{ st.state.solar_mode }}</div>
      </div>
      <div class="mini">
        <div class="mini-title">EV</div>
        <div class="big">{{ "ON" if st.state.ev_enabled else "OFF" }}</div>
      </div>
    </div>

    <div class="divider"></div>

    <h3>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏à‡∏≥‡∏•‡∏≠‡∏á‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î (30 ‡∏ß‡∏±‡∏ô)</h3>
    <div class="tablewrap">
      <table>
        <thead>
          <tr>
            <th>Day</th>
            <th>kWh ‡∏£‡∏ß‡∏°</th>
            <th>‡∏Ñ‡πà‡∏≤‡πÑ‡∏ü (‡∏ø)</th>
            <th>On‚ÄëPeak kWh</th>
            <th>Off‚ÄëPeak kWh</th>
            <th>Solar ‡πÉ‡∏ä‡πâ‡πÄ‡∏≠‡∏á kWh</th>
            <th>EV kWh</th>
            <th>‡πÄ‡∏ß‡∏•‡∏≤</th>
          </tr>
        </thead>
        <tbody>
          {% for r in rows %}
            <tr>
              <td>{{ r.day }}</td>
              <td>{{ "%.2f"|format(r.kwh_total) }}</td>
              <td>{{ "%.2f"|format(r.cost_thb) }}</td>
              <td>{{ "%.2f"|format(r.kwh_on) }}</td>
              <td>{{ "%.2f"|format(r.kwh_off) }}</td>
              <td>{{ "%.2f"|format(r.kwh_solar_used) }}</td>
              <td>{{ "%.2f"|format(r.kwh_ev) }}</td>
              <td class="muted small">{{ r.created_at }}</td>
            </tr>
          {% endfor %}
          {% if not rows %}
            <tr><td colspan="8" class="muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‚Äî ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ ‚Äú‡∏ö‡πâ‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô‚Äù ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î‡∏à‡∏≥‡∏•‡∏≠‡∏á 1 ‡∏ß‡∏±‡∏ô</td></tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </main>
</div>
</body>
</html>
